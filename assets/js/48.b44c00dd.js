(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{356:function(t,s,a){"use strict";a.r(s);var n=a(19),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"server-01-宝塔面板搭建服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#server-01-宝塔面板搭建服务器"}},[t._v("#")]),t._v(" Server-01 宝塔面板搭建服务器")]),t._v(" "),a("h2",{attrs:{id:"一、下载软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、下载软件"}},[t._v("#")]),t._v(" 一、下载软件")]),t._v(" "),a("p",[t._v("putty | xshell：连接远程linux服务器")]),t._v(" "),a("p",[t._v("winscp | FileZilla： 连接ftp的；")]),t._v(" "),a("p",[t._v("安装宝塔面板："),a("a",{attrs:{href:"https://www.bt.cn/bbs/thread-19376-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.bt.cn/bbs/thread-19376-1-1.html"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("宝塔面板功能：直接在linux系统里面输入bt，会打开菜单，选择对应的指令即可；")]),t._v(" "),a("h2",{attrs:{id:"二、上传网站"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、上传网站"}},[t._v("#")]),t._v(" 二、上传网站")]),t._v(" "),a("ol",[a("li",[t._v("将vue进行打包操作，并压缩，格式需要是zip的格式；")]),t._v(" "),a("li",[t._v("添加站点，将域名添加为站点，之后点击进入目录，")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-01.png",alt:"image"}})]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("进入文件目录之后，将压缩好的文件上传并解压，之后就可以访问了；")])]),t._v(" "),a("h2",{attrs:{id:"三、连接数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、连接数据库"}},[t._v("#")]),t._v(" 三、连接数据库")]),t._v(" "),a("ol",[a("li",[t._v("安装好宝塔面板之后，安装mongodb和pm2")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-02.png",alt:"image"}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("在linux系统里面输入mongo，管理mongodb数据库；可以直接通过本地连接进行")]),t._v(" "),a("li",[t._v("将json文件数据库传入服务器（直接将文件上传上面是不能访问的），之后在linux系统里面使用mongo import将数据库导入，并使用db.collections.find()查询一下，如果有数据，则上传成功了；")])]),t._v(" "),a("h2",{attrs:{id:"四、本地连接mongodb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、本地连接mongodb"}},[t._v("#")]),t._v(" 四、本地连接mongodb")]),t._v(" "),a("ol",[a("li",[t._v("在宝塔面板将mongodb的端口放开，并在安全里面放行27017端口，在服务器后台也放行端口；")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-03.png",alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-04.png",alt:"image"}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("在图形化mongodb软件里面，新建连接并将原有的localhost删除，否则不能连接；")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-05.png",alt:"image"}})]),t._v(" "),a("h2",{attrs:{id:"五、上传基于node的网站"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、上传基于node的网站"}},[t._v("#")]),t._v(" 五、上传基于node的网站")]),t._v(" "),a("ol",[a("li",[t._v("将node的文件夹进行压缩（不要删除node_modules），之后将压缩包上传到宝塔面板上，之后解压；")]),t._v(" "),a("li",[t._v("安装pm2管理器，并打开pm2管理器")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-06.png",alt:"image"}})]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("点击文件夹，选中上传的node，并输入启动文件名，输入项目名称；")]),t._v(" "),a("li",[t._v("添加成功之后点击映射，映射到域名上（域名需要在域名解析添加）；")])]),t._v(" "),a("h2",{attrs:{id:"六、配置nginx反向代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、配置nginx反向代理"}},[t._v("#")]),t._v(" 六、配置nginx反向代理")]),t._v(" "),a("p",[t._v("注意api必须加上，检查api的地方，修改之后记得重启nginx服务器；")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("    location /api "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        rewrite ^.+api/?"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(".*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ /"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_pass http://39.107.127.240:3000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 作用和proxyTable差不多  上传时记得删除这句话")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-07.png",alt:"image"}})]),t._v(" "),a("h2",{attrs:{id:"七、nginx常用配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#七、nginx常用配置"}},[t._v("#")]),t._v(" 七、nginx常用配置")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name wyy.heny.vip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 避免非root路径404")]),t._v("\n    location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解决跨域")]),t._v("\n    location /api "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        proxy_pass http://wyy.heny.vip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 为带hash值的文件配置永久缓存")]),t._v("\n    location ~* "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("?:css"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        expires 1y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        add_header Cache-Control "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"public"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    location ~ ^.+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("+$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("解决socket中nginx转发问题：")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name  school.godotdotdot.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    charset utf-8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    location ~ / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        proxy_pass http://127.0.0.1:3000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_http_version "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header Upgrade "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_upgrade")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header Connection "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"upgrade"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_connect_timeout "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_read_timeout "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        proxy_send_timeout "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    error_page   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("502")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("503")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("504")]),t._v("  /50x.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" /50x.html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        root   html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("nginx：try_file常用配置："),a("a",{attrs:{href:"https://www.hi-linux.com/posts/53878.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.hi-linux.com/posts/53878.html"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("总结笔记："),a("a",{attrs:{href:"http://jsanntq.cn/2020/04/07/Nginx/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://jsanntq.cn/2020/04/07/Nginx/"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"八、配置https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#八、配置https"}},[t._v("#")]),t._v(" 八、配置https")]),t._v(" "),a("ol",[a("li",[t._v("到阿云搜索ssl，之后云开通ssl，免费型的可以使用https一个二级域名；")]),t._v(" "),a("li",[t._v("配置了https的域名，域名头部访问就不再是一个不安全的标示了；")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-08.png",alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-09.png",alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-10.png",alt:"image"}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("进入ssl控制台，进行下载文件，下载nginx的，绑定的域名如果需要更换可以进行吊销，之后重新购买；")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-11.png",alt:"image"}})]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("打开宝塔面板，将下载好的key和pem代码复制进去；")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://notecdn.heny.vip/images/server-01_%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8-12.png",alt:"image"}})]),t._v(" "),a("h2",{attrs:{id:"九、添加网站"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#九、添加网站"}},[t._v("#")]),t._v(" 九、添加网站")]),t._v(" "),a("ol",[a("li",[t._v("在宝塔面板配置之后，还得在域名解析上面解析一个二级域名")])])])}),[],!1,null,null,null);s.default=e.exports}}]);