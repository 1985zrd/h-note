(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{436:function(s,t,e){"use strict";e.r(t);var a=e(19),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"node-06-加密-cookie-ejs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#node-06-加密-cookie-ejs"}},[s._v("#")]),s._v(" node-06 加密 cookie ejs")]),s._v(" "),e("h2",{attrs:{id:"一、find"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、find"}},[s._v("#")]),s._v(" 一、find")]),s._v(" "),e("p",[s._v("find方法：find()返回符合条件的元素，之后的值不会再调用执行函数，如果找不到返回undefined，不会改变原数组；")]),s._v(" "),e("p",[s._v("语法：arr.find((item,index,arr)=>{})；")]),s._v(" "),e("p",[s._v("findIndex：返回符合条件的元素的索引位置，没有返回-1，不改变原数组；")]),s._v(" "),e("h2",{attrs:{id:"二、加密"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、加密"}},[s._v("#")]),s._v(" 二、加密")]),s._v(" "),e("ol",[e("li",[s._v("引入模板：require('crypto')；")]),s._v(" "),e("li",[s._v("散列算法(哈希)加密：")])]),s._v(" "),e("p",[s._v("散列算法也叫哈希算法，把任意长度的输入变换成固定长度的输出，常见有md5,sha1,sha256等,需要跟一个密钥，密钥随便写；")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("crypto.createHmac('md5','hny#@!').update(str).digest('hex');\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("哈希算法：")])]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("crypto"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("createHash")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'md5'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("str"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("digest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hex'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("；\n")])])]),e("p",[s._v("加密之后的判断，再用户输入完成之后再次加密，再进行对比；")]),s._v(" "),e("h2",{attrs:{id:"三、cookie"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、cookie"}},[s._v("#")]),s._v(" 三、cookie")]),s._v(" "),e("p",[s._v("主要解决http协议无状态问题（没有记忆）；")]),s._v(" "),e("ol",[e("li",[s._v("在nodejs使用cookie")])]),s._v(" "),e("p",[s._v("（1）设置：res.setHeader('Set-Cookie',['name=hny','age=18']);")]),s._v(" "),e("p",[s._v("（2）获取：req.headers；（也可以使用中间件来获取req.cookie）")]),s._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[s._v("在express中使用cookie")])]),s._v(" "),e("p",[s._v("需要使用中间件：cookie-parser；之后使用app.use(cookieParser())；使用一下；")]),s._v(" "),e("p",[s._v("（1）设置：res.cookie(name,value[,option])；")]),s._v(" "),e("p",[s._v("可选：expires : 时间对象   new Date( new Date().getTime() +1"),e("em",[s._v("24")]),s._v("60"),e("em",[s._v("60")]),s._v("1000 )")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("    expires : 时间对象   new Date( Date.now() +1*24*60*60*1000 )\n\n    maxAge：1*24*60*60*1000；以毫秒为单位；\n\nhttpOnly：布尔值，客户端不能设置cookie；\n\npath：只允许指定的位置访问；\n\ndomain：只允许指定的域名访问；\n\n修改host文件：C:\\Windows\\System32\\drivers\\etc；ip地址+域名；指定域名为本地域名；\n")])])]),e("p",[s._v("（2）获取：req.cookies；")]),s._v(" "),e("h2",{attrs:{id:"四、cookie-session；"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四、cookie-session；"}},[s._v("#")]),s._v(" 四、cookie-session；")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("需要npm 下载一下；\n")])])]),e("ol",[e("li",[e("p",[s._v("引用：require('cookie-session')；")])]),s._v(" "),e("li",[e("p",[s._v("使用：app.use(cookieSession({})；")]),s._v(" "),e("p",[s._v("对象里面：name:cookie名字,")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("              keys:[]；密钥，随意多个； 必填；需要方括号;\n\n              maxAge；过期时间，以毫秒为单位；\n")])])])]),s._v(" "),e("li",[e("p",[s._v("设置cookie：req.session.username = 'hny';")])]),s._v(" "),e("li",[e("p",[s._v("获取cookie：req.session.username；")])]),s._v(" "),e("li",[e("p",[s._v("如果需要删除cookie，可以让值等于空；")])])]),s._v(" "),e("p",[s._v("当cookie里面存有session  id时，需要获取到存的cookie，需要设置相同的name和keys，才能通过req.session拿值；")]),s._v(" "),e("p",[s._v("cookie和session的区别：")]),s._v(" "),e("p",[s._v("（1）(失效)Session 会在浏览器关闭之后失效，Cookie 则可以在理论上永久有效(设置过期时间)。")]),s._v(" "),e("p",[s._v("（2）(存放)Cookie 数据存放在客户的浏览器上， Session 数据存放在服务器上。")]),s._v(" "),e("p",[s._v("（3）(黑客)Cookie 不安全，黑客可以分析本地的 Cookie, 并进行 Cookie 欺骗。 而 Session 保存在远程服务器上，相对安全（重要的信息应该存在session）;")]),s._v(" "),e("p",[s._v("（4）(限制)Cookie有大小限制，一般是4KB。 域名20-50个以内，Session 则没有这方面的限制。")]),s._v(" "),e("p",[s._v("（5）(禁用)浏览器的设置可能禁用 Cookie，这时所有关于 Cookie 的应用都将失败，但是 Session 却永远不会有这个问题；")]),s._v(" "),e("p",[s._v("session与cookie的联系：\nSession 依赖 cookie，因为 session id 存在客户端。")]),s._v(" "),e("h2",{attrs:{id:"五、模板引擎ejs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五、模板引擎ejs"}},[s._v("#")]),s._v(" 五、模板引擎ejs")]),s._v(" "),e("p",[s._v("渲染页面：新闻列表页中的显示的内容不同，但显示的风格都一样，就可以作为一个模板，实际上就是渲染页面；")]),s._v(" "),e("p",[s._v("前端渲染：前端渲染都使用的ajax的技术，但不利于seo优化；")]),s._v(" "),e("p",[s._v("后端渲染：使用模板引擎，有利于seo优化；")]),s._v(" "),e("ol",[e("li",[s._v("下载ejs包，之后不需要手动引入")])]),s._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'view engine'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ejs'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//设置引擎；")]),s._v("\napp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'views'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("__dirname"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/views'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'template'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//按照顺序指定模板目录")]),s._v("\napp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("engine")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'html'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ejs'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("__express"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//告诉express html以ejs模板引擎去渲染")]),s._v("\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("res.render('index',[,data])；使用ejs引擎；")])]),s._v(" "),e("p",[s._v("注意：传入的index文件不需要后缀，会自动去views文件夹中找模板文件，后面传入数据，多个可使用对象，在ejs模板中使用：")]),s._v(" "),e("p",[s._v("（1）<%= 键名%>；必须一一般的字符才用%=，如果如果使用标签会被转换成实体符号;")]),s._v(" "),e("p",[s._v("（2）如果是标签：<%- 键名%>；")]),s._v(" "),e("p",[s._v("（3）使用js遍历循环：")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("第一行写左大括号，中间写语句，最后一行写右大括号；\n\n<% for(let i=0;i<arr.length;i++){%>\n\n        <%=arr[i]%>\n\n        <%}%>；\n")])])]),e("p",[s._v("（4）使用公共模板：<% include header %>；")])])}),[],!1,null,null,null);t.default=n.exports}}]);